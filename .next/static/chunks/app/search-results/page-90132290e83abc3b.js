(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[712],{9593:(e,r,t)=>{Promise.resolve().then(t.bind(t,5266))},5266:(e,r,t)=>{"use strict";t.d(r,{default:()=>T});var s=t(5155),a=t(2115),n=t(6046),o=t(9602);let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,o.cn)("w-full caption-bottom text-sm",t),...a})})});l.displayName="Table";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("thead",{ref:r,className:(0,o.cn)("[&_tr]:border-b",t),...a})});i.displayName="TableHeader";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tbody",{ref:r,className:(0,o.cn)("[&_tr:last-child]:border-0",t),...a})});c.displayName="TableBody",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tfoot",{ref:r,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tr",{ref:r,className:(0,o.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});d.displayName="TableRow";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("th",{ref:r,className:(0,o.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});u.displayName="TableHead";let m=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("td",{ref:r,className:(0,o.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});m.displayName="TableCell",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("caption",{ref:r,className:(0,o.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption";var f=t(6352),h=t(8867);let p=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(f.bL,{ref:r,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,s.jsx)(f.C1,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(h.A,{className:"h-4 w-4"})})})});p.displayName=f.bL.displayName;var x=t(4085),g=t(7364),b=t(6719),y=t(8173),v=t.n(y),j=t(7058),N=t(9904),w=t(2818);let E={apiKey:w.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:w.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:w.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:w.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:w.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:w.env.NEXT_PUBLIC_FIREBASE_APP_ID},_=(0,N.Dk)().length>0?(0,N.Sx)():(0,N.Wp)(E),S=(0,j.aU)(_);function P(e){let{children:r,variant:t,onClose:n}=e,[o,l]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=setTimeout(()=>{l(!1),n()},3e3);return()=>clearTimeout(e)},[n]),o)?(0,s.jsx)("div",{className:"fixed bottom-4 right-4 p-4 rounded-md text-white ".concat("success"===t?"bg-green-500":"bg-red-500"),children:r}):null}function R(e){let{className:r,color:t="bg-yellow-400",...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("w-full h-1",t,r),...a})}function T(){let[e,r]=(0,a.useState)([]),[t,o]=(0,a.useState)(new Set),[f,h]=(0,a.useState)(!0),[y,N]=(0,a.useState)(null),[w,E]=(0,a.useState)(null),_=(0,n.useSearchParams)(),T=(0,n.useRouter)();return((0,a.useEffect)(()=>{let e=!0;return(async()=>{h(!0),N(null);try{let t;let s=_.get("propertyType"),a=_.get("location");if(console.log("Search parameters:",{propertyType:s,location:a}),!s||!a)throw Error("Missing required search parameters");let n=(0,j.rJ)(S,"properties");if(!n)throw Error("Properties collection reference is invalid");console.log("Attempting to query Firestore...");let o=(0,j.P)(n,(0,j._M)("propertyType","==",s));console.log("Query created:",o);try{t=await (0,j.GG)(o),console.log("Query executed successfully")}catch(e){throw console.error("Query execution failed:",e),Error("Query failed: ".concat(e.message||"Unknown error"))}if(t.empty){console.log("Query returned no results"),e&&(r([]),E({message:"No properties found matching your criteria",variant:"error"}));return}console.log("Query returned ".concat(t.size," documents"));let l=[];t.forEach(e=>{try{let r=e.data();if(console.log("Processing document:",e.id,r),!r.propertyType||!r.address){console.warn("Document ".concat(e.id," is missing required fields"));return}l.push({id:e.id,address:r.address,saleDate:r.saleDate instanceof j.Dc?r.saleDate.toDate():new Date,actualCapRate:Number(r.actualCapRate)||0,pricePerUnit:Number(r.pricePerUnit)||0,numberOfUnits:Number(r.numberOfUnits)||0,yearBuilt:Number(r.yearBuilt)||0,propertyType:r.propertyType,totalSquareFeet:Number(r.totalSquareFeet)||0})}catch(r){console.error("Error processing document:",e.id,r)}}),console.log("Processed ".concat(l.length," valid properties")),e&&(r(l),l.length>0&&E({message:"Found ".concat(l.length," properties"),variant:"success"}))}catch(t){console.error("Error in fetchProperties:",t),t.code&&console.error("Firebase error code:",t.code),t.message&&console.error("Error message:",t.message),t.stack&&console.error("Error stack:",t.stack);let r="Failed to fetch properties. Please try again later.";"permission-denied"===t.code?r="Access denied. Please check your permissions.":"not-found"===t.code?r="The requested data could not be found.":t.message&&(r=t.message),e&&(N(r),E({message:r,variant:"error"}))}finally{e&&h(!1)}})(),()=>{e=!1}},[_]),f)?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):y?(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,s.jsx)(x.$,{variant:"ghost",size:"icon",onClick:()=>T.back(),children:(0,s.jsx)(g.A,{className:"h-4 w-4"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Search Results"})]}),(0,s.jsxs)("div",{className:"text-red-500 p-4 rounded-lg border border-red-200 bg-red-50",children:[(0,s.jsx)("p",{className:"font-medium",children:"Error"}),(0,s.jsx)("p",{children:y})]})]}):(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,s.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.$,{variant:"ghost",size:"icon",onClick:()=>T.back(),children:(0,s.jsx)(g.A,{className:"h-4 w-4"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Search Results"})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[e.length," properties found"]})})]}),(0,s.jsx)(R,{}),e.length>0?(0,s.jsx)("div",{className:"overflow-x-auto rounded-lg border",children:(0,s.jsxs)(l,{children:[(0,s.jsx)(i,{children:(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{className:"w-[50px]"}),(0,s.jsx)(u,{children:"Address"}),(0,s.jsx)(u,{children:"Sale Date"}),(0,s.jsx)(u,{children:"Cap Rate"}),(0,s.jsx)(u,{children:"Price Per Unit"}),(0,s.jsx)(u,{children:"Number of Units"}),(0,s.jsx)(u,{children:"Year Built"}),(0,s.jsx)(u,{children:"Property Type"}),(0,s.jsx)(u,{children:"Total Square Feet"})]})}),(0,s.jsx)(c,{children:e.map(e=>(0,s.jsxs)(d,{children:[(0,s.jsx)(m,{children:(0,s.jsx)(p,{checked:t.has(e.id),onCheckedChange:()=>{o(r=>{let t=new Set(r);return t.has(e.id)?t.delete(e.id):t.add(e.id),t})}})}),(0,s.jsx)(m,{children:(0,s.jsx)(v(),{href:"/property/".concat(e.id),className:"text-blue-600 hover:underline",children:e.address})}),(0,s.jsx)(m,{children:(0,b.GP)(e.saleDate,"PP")}),(0,s.jsxs)(m,{children:[e.actualCapRate.toFixed(2),"%"]}),(0,s.jsxs)(m,{children:["$",e.pricePerUnit.toLocaleString()]}),(0,s.jsx)(m,{children:e.numberOfUnits}),(0,s.jsx)(m,{children:e.yearBuilt}),(0,s.jsx)(m,{children:e.propertyType}),(0,s.jsx)(m,{children:e.totalSquareFeet.toLocaleString()})]},e.id))})]})}):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No properties found matching your search criteria"})]}),t.size>0&&(0,s.jsx)("div",{className:"mt-4 flex justify-end",children:(0,s.jsxs)(x.$,{children:["Run Report (",t.size," selected)"]})}),w&&(0,s.jsx)(P,{variant:w.variant,onClose:()=>E(null),children:w.message})]})}},4085:(e,r,t)=>{"use strict";t.d(r,{$:()=>c});var s=t(5155),a=t(2115),n=t(2317),o=t(1027),l=t(9602);let i=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,size:o,asChild:c=!1,...d}=e,u=c?n.DX:"button";return(0,s.jsx)(u,{className:(0,l.cn)(i({variant:a,size:o,className:t})),ref:r,...d})});c.displayName="Button"},9602:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var s=t(3463),a=t(9795);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[992,169,197,441,517,358],()=>r(9593)),_N_E=e.O()}]);